package org.inchain.network;

import java.net.InetSocketAddress;

import org.inchain.Configure;
import org.inchain.crypto.Sha256Hash;
import org.inchain.message.DefaultMessageSerializer;
import org.inchain.message.MessageSerializer;
import org.inchain.store.BlockStore;
import org.inchain.utils.Hex;
import org.inchain.utils.Utils;

/**
 * 测试网络
 * @author ln
 *
 */
public class TestNetworkParams extends NetworkParams {

	public TestNetworkParams() {
		seedManager = new RemoteSeedManager();

		seedManager.addDnsSeed("test1.seed.inchain.org");
		seedManager.addDnsSeed("test2.seed.inchain.org");

//    	seedManager.add(new Seed(new InetSocketAddress("47.93.16.125", Configure.DEFAULT_PORT)));
//    	seedManager.add(new Seed(new InetSocketAddress("119.23.249.26", Configure.DEFAULT_PORT)));
//   	seedManager.add(new Seed(new InetSocketAddress("119.23.253.3", Configure.DEFAULT_PORT)));
//    	seedManager.add(new Seed(new InetSocketAddress("119.23.254.99", Configure.DEFAULT_PORT)));
//		seedManager.add(new Seed(new InetSocketAddress("192.168.1.190", Configure.DEFAULT_PORT)));
//		seedManager.add(new Seed(new InetSocketAddress("192.168.1.186", Configure.DEFAULT_PORT)));
		init();
	}


	public TestNetworkParams(SeedManager seedManager) {
		this.seedManager = seedManager;
		init();
	}

	private void init() {

		id = ID_TESTNET;

		packetMagic = 629266579L;

		this.acceptableAddressCodes = new int[] {getSystemAccountVersion(), getCertAccountVersion()};
	}

	/**
	 * 测试网络的创世块
	 */
	@Override
	public BlockStore getGengsisBlock() {
		BlockStore gengsisBlock = new BlockStore(this, Hex.decode("0000000000000000000000000000000000000000000000000000000000000000000000007c44f2d51fe5e7b757ddb48b553ec0a8520e0863309e70d0adc88a8015806fcd73fa695900000000000073fa6959822102883a9625a871e79c070e316edafc97eac2f6c97b218d0e55726f25be2a963e9276a9144237cccf6ff9a7674a8fc47c60278fdd23e9f3098846304402202ada7a7ef5313896dec13991b8060304b253c28a8dd2a038d1626a411d7eae1b0220030d94e92d514ce3e578d197bb15cb09c1be4bad8f1a04e618774205f44daa0bac140101000000010012117468697320612067656e6773697320747800000000010080faca73f91f00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688ac73fa69590000000000020100000001015f3007aa69437b732c93b9fb12adae9de270a768647c2c1e4b36303785b29f3e000000006b483045022100fcb1a6c616da1a07cddc651b935960687e4a4e073d66ef29628c67b58a24db32022017f2089ef376b22cfeea17796d24ca0a8a83032cf52ca761dcfc15353ccb535501210276c52ff14acd4c4d3e08f9596e0127a15e98207b3d0024426364825cd724c86dffffffff020080c6a47e8d03000078c2481976a9144237cccf6ff9a7674a8fc47c60278fdd23e9f30988ac00003426f56b1c00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688ac73fa69590000000000060100000073fa695900000000832102883a9625a871e79c070e316edafc97eac2f6c97b218d0e55726f25be2a963e9276a9144237cccf6ff9a7674a8fc47c60278fdd23e9f309884730450221009d7d2a19184f321376edca0b25955ff50fbb1550167266fd6705eb482a935dbe0220111a58ae7a7f06c57a7f74ffb536d0e562b7f798853b772e9a8fbf55267d8d7eac4237cccf6ff9a7674a8fc47c60278fdd23e9f30901000000000000000000000000000000000000000000000000000000000000000000000000000000000201000000010158e40e48cd640316cd8a2db6b30588f113456de06b25609d5cd64899f242a45f010000006a473044022055473e89ff9548fbe8147fc7532b11509d6b1b9271151488f2aa26bd950ad8ef022047d371d96f4fcffe7c694459c674ffeb36f87c679621adc0c6c6450df5a78c9201210276c52ff14acd4c4d3e08f9596e0127a15e98207b3d0024426364825cd724c86dffffffff020010a5d4e8000000000000001976a9144237cccf6ff9a7674a8fc47c60278fdd23e9f30988ac00f08e510c6b1c00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688ac73fa695900000000000301000000000073fa69590000000000822102883a9625a871e79c070e316edafc97eac2f6c97b218d0e55726f25be2a963e9276a9144237cccf6ff9a7674a8fc47c60278fdd23e9f309884630440220499be440136db75fc3a4a9f248a9b525fcc18370451fdcf99314ca9e9540ba1b022050e230d62ff72502d8c9fa01d237c2fb80353a38b8733c977d4739e6bc66a61eac6b54fa454237cccf6ff9a7674a8fc47c60278fdd23e9f309060100000073fa695900000000822103a7db4a854e3f2ae3a30aa759bfd39045f6a80c967b3fd81036acebc54b557ece76a9142c1179b1e05fb8652644f6c61a033d284310091288463044022055c384e3779eb4269e03b54e0316ddfa65a635abfcb7c753bf46d3dd23457921022050b2f0224b068d5cfbb3ceaaae341f32dcc55a8fe3bf5be23ec484cc77508a57ac2c1179b1e05fb8652644f6c61a033d2843100912010000000000000000000000000000000000000000000000000000000000000000000000000000000002010000000101ea464d921c334ab55cf2eb084b6351c8889083b2a5fdfa2fe4930987406da691010000006b483045022100be256cc0f80fd18ffebf4638c19cd0a4180bd156f87a1f88a9ac79640582b62e022012fe4ca47d8457e51f96a0db068b9eeade76dc549145ed032aff9a7723ef191c01210276c52ff14acd4c4d3e08f9596e0127a15e98207b3d0024426364825cd724c86dffffffff020010a5d4e8000000000000001976a9142c1179b1e05fb8652644f6c61a033d284310091288ac00e0e97c236a1c00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688ac73fa695900000000000301000000000073fa69590000000000832103a7db4a854e3f2ae3a30aa759bfd39045f6a80c967b3fd81036acebc54b557ece76a9142c1179b1e05fb8652644f6c61a033d284310091288473045022100d3f88c7c28b69a1cc16e8a779eff64cc8ecbb62250741cc41aeb4e7703c9feaf022042671f8c202066fd9c880885723058d646d2e257d29758935989f508c4ca0752ac7b54fa452c1179b1e05fb8652644f6c61a033d2843100912060100000073fa6959000000008221033e371b2f3d42dd525833bcce12cb0d404fb73898bdea3e6794bd8ec552c9ba9c76a914b3fcd687a5c2b2617de0d504cfa7d12db93bb00c88463044022020e647c055596865d7cbf7934363e0f57ae4d31e8fde071d78df997d80ea7f7e02200c09baaab65296e93b7a30d4612119f76e4ab59aef4bc744551aae81444221bbacb3fcd687a5c2b2617de0d504cfa7d12db93bb00c010000000000000000000000000000000000000000000000000000000000000000000000000000000002010000000101e43c08b34a77706873d2c2c8111ac202e0b19af085dc64e9bad8a6c61d6adcd1010000006b483045022100ca2e824029a0b51af6b5d989893d5cb2df992c3f27fca25b6be97e567d4d10260220034dd37543afc664d99ac041405f71aae062187ca790024b6e2ecb78b6fd434601210276c52ff14acd4c4d3e08f9596e0127a15e98207b3d0024426364825cd724c86dffffffff020010a5d4e8000000000000001976a914b3fcd687a5c2b2617de0d504cfa7d12db93bb00c88ac00d044a83a691c00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688ac73fa695900000000000301000000000073fa695900000000008221033e371b2f3d42dd525833bcce12cb0d404fb73898bdea3e6794bd8ec552c9ba9c76a914b3fcd687a5c2b2617de0d504cfa7d12db93bb00c884630440220614495c3b30ed45c0f6c8f2b95ab6dd1ae0e5296c039cb3799f14f96096cfe2402204b942abc0860a48b34efbbd65a77623cc8411ca8baadaf350ab5a023b0114dd5ac7f54fa45b3fcd687a5c2b2617de0d504cfa7d12db93bb00c060100000073fa695900000000832103bf7759e9b81f8ff1b99732b3ee36aea0abff68c818b8839c318ad350e9642cb076a914c3bfdb8a67f35b6e4ea1ee3ae7b91eff58ec81a888473045022100b9b223c002dac426f6b8043bf6fe7238c1230066fecd2335a36afb7730b4d714022078213a59bb9b0b2a4eaa166ed0567f080e9860cde0d3c6ae14c044c366788a0dacc3bfdb8a67f35b6e4ea1ee3ae7b91eff58ec81a8010000000000000000000000000000000000000000000000000000000000000000000000000000000002010000000101f40224f792b1db63a096b29999e1aaea8695e02fe7bc8045dcbef8bfa3ad3b7f010000006b483045022100fdcc3e25f607ac39c2329ea15d498a307c3b2b797bc2092cbe3792768b94636e022030d712090911a1357ff32ad61fd4cf3e08c9474c2191640ba77295fd5a143d4801210276c52ff14acd4c4d3e08f9596e0127a15e98207b3d0024426364825cd724c86dffffffff020010a5d4e8000000000000001976a914c3bfdb8a67f35b6e4ea1ee3ae7b91eff58ec81a888ac00c09fd351681c00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688ac73fa69590000000000060100000073fa69590000000083210200d482122f8537ad2fa1af1914e088d6b308824a8ef4dc8b68fa0e0a88c484e376a9145f1a078b610d92a3110b2c1a7f880b0d2442e53088473045022100efcb9319a8b11c106d2d73c28b87b21ba0ba4fee2475dad8d6d457325849524e02205e6e40f97375de774e059f64f501a7a397e7374a2c691bd3ceaf76a24f155980ac5f1a078b610d92a3110b2c1a7f880b0d2442e53001000000000000000000000000000000000000000000000000000000000000000000000000000000000201000000010138dc106ca0154f79b63be297576bd5877ca4143cf503b2e5a0009d6a8de531a0010000006b483045022100e5f66ea25f9b0b0572629691d4f7259cc7cae285a8d2756048d413bd110e03130220230e043dc47b163897d76287ce129ba919c95c9cb7c94e3cc737e839df63df4b01210276c52ff14acd4c4d3e08f9596e0127a15e98207b3d0024426364825cd724c86dffffffff020010a5d4e8000000000000001976a9145f1a078b610d92a3110b2c1a7f880b0d2442e53088ac00b0fafe68671c00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688ac73fa69590000000000060100000073fa695900000000822103e8769d1901a4ef006054405c16716d6648fffe628385db5586c7fa18c3df5da876a914df639c6066a817a6be28b532839f8e1e85594cd488463044022079db7ffc015cfff88bdd386f0743e6eeeaf46dbba4ca0d843a22bd50200691360220530baa25fbdfe7cfe98ab90fe1e3ec33ec313de4d82ac321088a5f41f01082a1acdf639c6066a817a6be28b532839f8e1e85594cd401000000000000000000000000000000000000000000000000000000000000000000000000000000000201000000010173ed5af71a3dd57c733051b771377eff44517054e6f7228cbc29d1bc03e660cb010000006b483045022100a1828964ba9bc57ca1a719c4a5e77e5abba0b7126abb309cafffdc4fd101935102207254434fafd3a6290900ceb84f68bbe2857f4b2189138e238aab8e0217d1ce4a01210276c52ff14acd4c4d3e08f9596e0127a15e98207b3d0024426364825cd724c86dffffffff020010a5d4e8000000000000001976a914df639c6066a817a6be28b532839f8e1e85594cd488ac00a0552a80661c00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688ac73fa69590000000000060100000073fa695900000000832103368f8061e02694e37da199c07c3e2f2506cdd748efee493f0d1c52ae7494428f76a914e3453a80144f6ac24baf01f20455c6167b98548588473045022100bd0c413cfa3f515f2e612bc2c82b7aa53af6f5846d20ce94b5057df1033d29bd02205f1d84627698fce697dbc88ad69591cec2a6a194d7810f8e8f93a7fd480da53cace3453a80144f6ac24baf01f20455c6167b985485010000000000000000000000000000000000000000000000000000000000000000000000000000000002010000000101cecdf132c5b84aba935f9392976eba1c2cc4e8d7aff7510438607d83edd6a623010000006b483045022100c6983336e764261905074fb126cbb09a33e5375c0f6e2d07e2739885af055b58022045abbcb43b7aac95d4fd80d2e28d343d391e20e3fbfb964c4dc91793f7fec26701210276c52ff14acd4c4d3e08f9596e0127a15e98207b3d0024426364825cd724c86dffffffff020010a5d4e8000000000000001976a914e3453a80144f6ac24baf01f20455c6167b98548588ac0090b05597651c00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688ac73fa695900000000000b01000000fbc5bf455d010000620fc5d169186bfb320802785fcb98982b260b46620fc5d169186bfb320802785fcb98982b260b4602fd23022b046e616d6506e5908de7a7b01ee9878de5ba86e58db0e993bee7a791e68a80e69c89e99990e585ace58fb822076164647265737306e59cb0e59d8012e9878de5ba86e5b882e58d97e5b2b8e58cba44046c6f676f06e59bbee7898737687474703a2f2f66696c652e696e636861696e2e6f72672f696d616765732f696e636861696e5f6c6f676f5f313030783130302e706e672b0a637265646974436f64650ce4bfa1e794a8e4bba3e7a0811239313530303130384d41355542333248334e1a0570686f6e6506e794b5e8af9d0c3032332d383633333130363927077765627369746506e5ae98e7bd911768747470733a2f2f7777772e696e636861696e2e6f7267fd1d0108646573637269707406e68f8fe8bfb0fd0a01e9878de5ba86e58db0e993bee7a791e68a80e69c89e99990e585ace58fb8e698afe4b880e5aeb6e4bba5e58cbae59d97e993bee68a80e69cafe9a9b1e58aa8e79a84e5889be696b0e59e8be4bc81e4b89aefbc8ce585b6e4b8bbe5afbce79a84e58cbae59d97e993bee7a4bee58cbae9a1b9e79bae496e636861696e2de58db0e993bee698afe4b880e4b8aae4bba5e998b2e4bcaae4b8bae59fbae7a180e4b89ae58aa1e79a84e585ace5bc80e5b9b3e58fb0efbc8ce4b8bae7a4bee4bc9ae59084e4bc81e4b89ae38081e69cbae69e84e38081e889bae69cafe5aeb6e7ad89e68f90e4be9be59381e7898ce38081e79fa5e8af86e4baa7e69d83e4bf9de68aa4e69c8de58aa1e38082022102dc8d76561bedf795802be088c238eedf41687c00d954fe8bd3c862c38812441c210300336a323ff20764bf8e88c00f35f97cde8e924a3d993f6d9a27e3dd1b15e97d012102e5d7a8540ea2adf597eec80ea8a7a2398435d6cffed0a56715aab35c6801c4e282c2207e64f98afbbf9f4a795c9a623e0d4c5020fa8fbe3ee989c2ec882ecd3a30cf17c314716b68dd463d01263a7ff4a7c52eae528d71439688473045022100ad8394885d8d7bf07e9c16fa666874cae25456c3fc007cbf9eea8585f78a7fd80220605d0417f31641c787d9d3d6e659335f2cef3aad3ecef8fd2cb7323389ac3a70ac"));

		Sha256Hash merkleHash = gengsisBlock.getBlock().buildMerkleHash();

		if(log.isDebugEnabled()) {
			log.debug("the gengsis block merkle hash is : {}", merkleHash);
		}
		Utils.checkState("7c44f2d51fe5e7b757ddb48b553ec0a8520e0863309e70d0adc88a8015806fcd".equals(Hex.encode(merkleHash.getBytes())), "the gengsis block merkle hash is error");

		if(log.isDebugEnabled()) {
			log.debug("the gengsis block hash key is : {}", gengsisBlock.getBlock().getHash());
		}
		Utils.checkState("591090b046d514f52e009087e2bdd476359b561467ee559b41da4f97514e07cc".equals(Hex.encode(gengsisBlock.getBlock().getHash().getBytes())), "the gengsis block hash is error");

		return gengsisBlock;

	}

	@Override
	public int getProtocolVersionNum(ProtocolVersion version) {
		return version.getVersion();
	}

	@Override
	public MessageSerializer getSerializer(boolean parseRetain) {
		return new DefaultMessageSerializer(this);
	}

	/**
	 * 获取该网络的认证管理账号的hash160
	 * @return byte[]
	 */
	@Override
	public byte[] getCertAccountManagerHash160() {


		//return Hex.decode("8e168bb4963f0523b9ee1c734d3c142976581930");//root
		//return Hex.decode("b326aeb9c6710864441b7c6a282ce924b4c31749");//manager
		return Hex.decode("481e05c83604abf86cca029c4260674c45c85c58");//cer_manager_1
	}

	@Override
	public byte[] getCommunityManagerHash160() {
		return Hex.decode("481e05c83604abf86cca029c4260674c45c85c58");//cer_manager_1
	}

	/**
	 * 测试网络，普通地址以t开头
	 */
	@Override
	public int getSystemAccountVersion() {
		return 128;
	}

	/**
	 * 测试网络，认证地址以c开头
	 */
	@Override
	public int getCertAccountVersion() {
		return 88;
	}
}
