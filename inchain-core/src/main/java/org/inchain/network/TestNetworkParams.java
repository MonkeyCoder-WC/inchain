package org.inchain.network;

import java.net.InetSocketAddress;

import org.inchain.Configure;
import org.inchain.crypto.Sha256Hash;
import org.inchain.message.DefaultMessageSerializer;
import org.inchain.message.MessageSerializer;
import org.inchain.store.BlockStore;
import org.inchain.utils.Hex;
import org.inchain.utils.Utils;

/**
 * 测试网络
 * @author ln
 *
 */
public class TestNetworkParams extends NetworkParams {

	public TestNetworkParams() {
		seedManager = new RemoteSeedManager();

//		seedManager.addDnsSeed("test1.seed.inchain.org");
//		seedManager.addDnsSeed("test2.seed.inchain.org");

//    	seedManager.add(new Seed(new InetSocketAddress("47.93.16.125", Configure.DEFAULT_PORT)));
//    	seedManager.add(new Seed(new InetSocketAddress("119.23.249.26", Configure.DEFAULT_PORT)));
//   	seedManager.add(new Seed(new InetSocketAddress("119.23.253.3", Configure.DEFAULT_PORT)));
//    	seedManager.add(new Seed(new InetSocketAddress("119.23.254.99", Configure.DEFAULT_PORT)));
		seedManager.add(new Seed(new InetSocketAddress("192.168.1.190", Configure.DEFAULT_PORT)));
        seedManager.add(new Seed(new InetSocketAddress("192.168.1.186", Configure.DEFAULT_PORT)));
		init();
	}
    

	public TestNetworkParams(SeedManager seedManager) {
    	this.seedManager = seedManager;
    	init();
	}
    
	private void init() {
		
		id = ID_TESTNET;
		
		packetMagic = 629266570l;
		
		this.acceptableAddressCodes = new int[] {getSystemAccountVersion(), getCertAccountVersion()};
	}
	
	/**
	 * 测试网络的创世块
	 */
	@Override
	public BlockStore getGengsisBlock() {
		BlockStore gengsisBlock = new BlockStore(this, Hex.decode("0000000000000000000000000000000000000000000000000000000000000000000000004f82d41f43deeed7e773011b3912f987969d9d612360e30c785189764c9bb127be676759000000000000be676759822102883a9625a871e79c070e316edafc97eac2f6c97b218d0e55726f25be2a963e9276a9144237cccf6ff9a7674a8fc47c60278fdd23e9f3098846304402205c4a7eacca9e567c8e253c929c862587bfbdc2ca5e0a0ba04978c1db02d47801022001301a4ff7a47eed3d3cec208c01bd7e99950a722799cbec1318d2d3f4964248ac150101000000010012117468697320612067656e6773697320747800000000010080faca73f91f00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688acbe676759000000000002010000000101db9ed3ee6b776a4d72022beb09c2cb4df0c3d056858df6c6612278cc0e069235000000006b483045022100fb6994c8eb032b22b195c2ab60826de4fd14d5c424c659ab789e2a24c74d7b5f02203fac80c60eb2e6a1a54398283e279ba4b2aa9c6eab0b9d0726fc35238b6c46da01210276c52ff14acd4c4d3e08f9596e0127a15e98207b3d0024426364825cd724c86dffffffff020080c6a47e8d03000078c2481976a9144237cccf6ff9a7674a8fc47c60278fdd23e9f30988ac00003426f56b1c00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688acbe67675900000000000601000000be67675900000000832102883a9625a871e79c070e316edafc97eac2f6c97b218d0e55726f25be2a963e9276a9144237cccf6ff9a7674a8fc47c60278fdd23e9f30988473045022100e4f632da958c0ee54a2b8154dc0642d54978668020a4a32ffb2d4f42825ecebb02200456f7a9f1791d6c2362b3ffc72fc24f3cf869d3ec251b2e594760bfbc6d8c8fac4237cccf6ff9a7674a8fc47c60278fdd23e9f3097f9698000000000000000000000000000000000000000000000000000000000000000000000000000002010000000101cc808fb9dcc097494968a7c64464a93f461f23bc23a792c68e486d04f0cc445c010000006b483045022100d9e1225c8add9ca7ffeb127285db7e8e7583d5074a6a2f0c0406863fee52ca2b022051c0bae659d76ab08b4e2711d0a6f5cc95697ebcd5b133526761a05f48d7af3001210276c52ff14acd4c4d3e08f9596e0127a15e98207b3d0024426364825cd724c86dffffffff020010a5d4e8000000000000001976a9144237cccf6ff9a7674a8fc47c60278fdd23e9f30988ac00f08e510c6b1c00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688acbe676759000000000003010000000000be6767590000000000832102883a9625a871e79c070e316edafc97eac2f6c97b218d0e55726f25be2a963e9276a9144237cccf6ff9a7674a8fc47c60278fdd23e9f30988473045022100d49f95c6d568166029608f12c0bf52750fca765b809d35aa28bacdd470818a0502204077c7124801000e1cd0bc3fc64d29645a8fad60bbac7b066c794323365923acacd23eed3b4237cccf6ff9a7674a8fc47c60278fdd23e9f3090601000000be67675900000000832103a7db4a854e3f2ae3a30aa759bfd39045f6a80c967b3fd81036acebc54b557ece76a9142c1179b1e05fb8652644f6c61a033d284310091288473045022100a95922eb68153025d3ebcb9a4665dc90de2cccabf68dc0eadbfd6d7c9cd805350220437b8f0a4e5c9d07d0099a5efe853ff347ddacaaf4789a2bb6adc2434e4f3c34ac2c1179b1e05fb8652644f6c61a033d28431009127f969800000000000000000000000000000000000000000000000000000000000000000000000000000201000000010182e145b65f1411c110bd5554d91579b0d20ed253e9242445d19b1060c98a5e55010000006b483045022100cb2433ed4be55483bffb2a8d8090bbc23294ceaf687ce92996233537a1d2a758022032f8fb64124829e46509b912279831fcfddb9bf9f6cdfb87d7f8137575808d2a01210276c52ff14acd4c4d3e08f9596e0127a15e98207b3d0024426364825cd724c86dffffffff020010a5d4e8000000000000001976a9142c1179b1e05fb8652644f6c61a033d284310091288ac00e0e97c236a1c00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688acbe676759000000000003010000000000be6767590000000000832103a7db4a854e3f2ae3a30aa759bfd39045f6a80c967b3fd81036acebc54b557ece76a9142c1179b1e05fb8652644f6c61a033d2843100912884730450221009503f28a2f0fa1fb45950b183e818c3b12d5604fc92ddbef0690dee84aa040d7022050e3dd72455908042cd77660e725711da6d363998a2d7de52bf80fd1f1ea5b48ace43eed3b2c1179b1e05fb8652644f6c61a033d28431009120601000000be676759000000008321033e371b2f3d42dd525833bcce12cb0d404fb73898bdea3e6794bd8ec552c9ba9c76a914b3fcd687a5c2b2617de0d504cfa7d12db93bb00c884730450221009d89600b7183e0e11ee8a3404df86c21e0d37b044e05e21da1f2357f73d99bcf02206ad656e047ad046bfa10f74db47ca117209c2ce43364488b34911292669c45f8acb3fcd687a5c2b2617de0d504cfa7d12db93bb00c7f969800000000000000000000000000000000000000000000000000000000000000000000000000000201000000010102402e9414e099dda2f88411fae8044cb1de0595bd1d2c269d25a3b22bdf3360010000006a47304402201cdac1b0203a0e986de746ab159f49a541e083c25440a15641559faf732a318d02203e9fa7ad97c110636a38c621761998757e4974248466fad15bb503413bfa255301210276c52ff14acd4c4d3e08f9596e0127a15e98207b3d0024426364825cd724c86dffffffff020010a5d4e8000000000000001976a914b3fcd687a5c2b2617de0d504cfa7d12db93bb00c88ac00d044a83a691c00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688acbe676759000000000003010000000000be67675900000000008221033e371b2f3d42dd525833bcce12cb0d404fb73898bdea3e6794bd8ec552c9ba9c76a914b3fcd687a5c2b2617de0d504cfa7d12db93bb00c884630440220734b9c69202434df816b90c9e4f9ff576fcbbae33961975575dd9e5d3fd41559022030bd14430134ec596a694b84ddd36f2f7b5cfe89f223081773f34fe18b25e8e2ace63eed3bb3fcd687a5c2b2617de0d504cfa7d12db93bb00c0601000000be67675900000000832103bf7759e9b81f8ff1b99732b3ee36aea0abff68c818b8839c318ad350e9642cb076a914c3bfdb8a67f35b6e4ea1ee3ae7b91eff58ec81a8884730450221009a276413847eec675f918f98e634d258f385eff1241fd6d79f68342e42c3bd8c0220012417787ce5ef55324e8c683eeb2d659b994a9c2c5f3eccc53dc1af8e3d2d93acc3bfdb8a67f35b6e4ea1ee3ae7b91eff58ec81a87f96980000000000000000000000000000000000000000000000000000000000000000000000000000020100000001016846579735c286b54360ae7a01839b807c85cd0faab2214734768c76e6e6570a010000006b483045022100edca6ea30fece74cd4072c5f7d23f71992e26ddac9d649c3e1ee960fcafc7f4f022031c837a6d7fb607db8f711070c51944a6f19c86d2026d57a66d7fe21242ebaaa01210276c52ff14acd4c4d3e08f9596e0127a15e98207b3d0024426364825cd724c86dffffffff020010a5d4e8000000000000001976a914c3bfdb8a67f35b6e4ea1ee3ae7b91eff58ec81a888ac00c09fd351681c00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688acbe67675900000000000601000000be6767590000000083210200d482122f8537ad2fa1af1914e088d6b308824a8ef4dc8b68fa0e0a88c484e376a9145f1a078b610d92a3110b2c1a7f880b0d2442e53088473045022100a2f7ec2011112532f13f374c60d4747db06510fc5d871739ff24e0b562cf8df0022002bdaac1d5babea20f7a82a0712272ee06b6af7b4862028ebc9c9854fbd7862aac5f1a078b610d92a3110b2c1a7f880b0d2442e5307f969800000000000000000000000000000000000000000000000000000000000000000000000000000201000000010165c44bad702effcf8bb2ef2a0d47a1ec777d811559dd87a6e8b3023e0514fa36010000006a4730440220480d8b1af6a5e10b80a15bb4b37c5d0a0a2930231c10f61ac8393c012b200b2102201d68005e8587a7973e7c4c112c15f8f6047e24662ca5e1e8d4e9c13849dbfe0001210276c52ff14acd4c4d3e08f9596e0127a15e98207b3d0024426364825cd724c86dffffffff020010a5d4e8000000000000001976a9145f1a078b610d92a3110b2c1a7f880b0d2442e53088ac00b0fafe68671c00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688acbe67675900000000000601000000be67675900000000822103e8769d1901a4ef006054405c16716d6648fffe628385db5586c7fa18c3df5da876a914df639c6066a817a6be28b532839f8e1e85594cd4884630440220255a74b73f1bfe11c4aa1c4af62d9aa2e93062cae77076d3c781804b36e1db9102207bcd6829c56e6a3dad0a0907ecada8b7322f4ea535bd17df85a4770c41373230acdf639c6066a817a6be28b532839f8e1e85594cd47f96980000000000000000000000000000000000000000000000000000000000000000000000000000020100000001014fc7ac8f82cf7d50c6d0e80289e8aaec83eca519efb76376087b7b7c95365792010000006b483045022100af18ceed3dd070a6f95352401d5abc28e0d500edf512274b621a9cc8ac242e2602203a3be45165b815b5438048d79ee84f7bab9a058247e32a3e06e1368c5876a38501210276c52ff14acd4c4d3e08f9596e0127a15e98207b3d0024426364825cd724c86dffffffff020010a5d4e8000000000000001976a914df639c6066a817a6be28b532839f8e1e85594cd488ac00a0552a80661c00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688acbe67675900000000000601000000be67675900000000822103368f8061e02694e37da199c07c3e2f2506cdd748efee493f0d1c52ae7494428f76a914e3453a80144f6ac24baf01f20455c6167b98548588463044022022652964f956533d5cb46d64a5b811feb015ce36b2eb49e080ff82b6650976f10220695af866187c2b13204e6a686121a970a987b26c9568a2ce18b55f43f03e374cace3453a80144f6ac24baf01f20455c6167b9854857f969800000000000000000000000000000000000000000000000000000000000000000000000000000201000000010182e6aa749785bfdd10e41cfe02597c68566665664aa346792e50e1009a49fa98010000006b483045022100bd441b72577f73c3db99449a023029e4c4d0cf283ea3a7c06e9474829bea89e3022076572b93f3051992615a0be801dd718dcc93c8d3e43a76dee2755056f5f7a9d801210276c52ff14acd4c4d3e08f9596e0127a15e98207b3d0024426364825cd724c86dffffffff020010a5d4e8000000000000001976a914e3453a80144f6ac24baf01f20455c6167b98548588ac0090b05597651c00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688acbe67675900000000000b0100000096c8de3b5d01000010f554df8b12a9532e1acbecf6798fd41e5829c510f554df8b12a9532e1acbecf6798fd41e5829c502fd23022b046e616d6506e5908de7a7b01ee9878de5ba86e58db0e993bee7a791e68a80e69c89e99990e585ace58fb822076164647265737306e59cb0e59d8012e9878de5ba86e5b882e58d97e5b2b8e58cba44046c6f676f06e59bbee7898737687474703a2f2f66696c652e696e636861696e2e6f72672f696d616765732f696e636861696e5f6c6f676f5f313030783130302e706e672b0a637265646974436f64650ce4bfa1e794a8e4bba3e7a0811239313530303130384d41355542333248334e1a0570686f6e6506e794b5e8af9d0c3032332d383633333130363927077765627369746506e5ae98e7bd911768747470733a2f2f7777772e696e636861696e2e6f7267fd1d0108646573637269707406e68f8fe8bfb0fd0a01e9878de5ba86e58db0e993bee7a791e68a80e69c89e99990e585ace58fb8e698afe4b880e5aeb6e4bba5e58cbae59d97e993bee68a80e69cafe9a9b1e58aa8e79a84e5889be696b0e59e8be4bc81e4b89aefbc8ce585b6e4b8bbe5afbce79a84e58cbae59d97e993bee7a4bee58cbae9a1b9e79bae496e636861696e2de58db0e993bee698afe4b880e4b8aae4bba5e998b2e4bcaae4b8bae59fbae7a180e4b89ae58aa1e79a84e585ace5bc80e5b9b3e58fb0efbc8ce4b8bae7a4bee4bc9ae59084e4bc81e4b89ae38081e69cbae69e84e38081e889bae69cafe5aeb6e7ad89e68f90e4be9be59381e7898ce38081e79fa5e8af86e4baa7e69d83e4bf9de68aa4e69c8de58aa1e380820221029916e7c3c5e5dc5b76ab9608f9ad92814818dd4ad9b1d3b7d74af2e193ca4c872103cc3d441d77ff030f464b521d52881ae17552355e705b317c3f8eefd0a030f2270121039f24fe88a89056832679ae96a02a3a30fd5881bff8bb4fd8fc1affc10ea2026281c220e31fc305262422b001064b65f1d263d4fa6b9700275d1ac8fe7048b462885119c314716b68dd463d01263a7ff4a7c52eae528d7143968846304402201a69de30f84891c6ab91db9d0eaee1498bd4cb9f2fa757207f7d39cade185baa02202f195c2323639a68f53debe998e37a7b8e73570153e9c7dac8c8aeee615306f4ac0b01000000ff61eb3b5d010000949d5a110ad87f5a75a5e674e6979ae23bff331e744dc39b4bb0bcaeb507654404676c46c1a635bd02fd24012b046e616d6506e5908de7a7b01ee9878de5ba86e58db0e993bee7a791e68a80e69c89e99990e585ace58fb822076164647265737306e59cb0e59d8012e9878de5ba86e5b882e58d97e5b2b8e58cba44046c6f676f06e59bbee7898737687474703a2f2f66696c652e696e636861696e2e6f72672f696d616765732f696e636861696e5f6c6f676f5f313030783130302e706e672b0a637265646974436f64650ce4bfa1e794a8e4bba3e7a0811239313530303130384d41355542333248334e1a0570686f6e6506e794b5e8af9d0c3032332d383633333130363927077765627369746506e5ae98e7bd911768747470733a2f2f7777772e696e636861696e2e6f72672008646573637269707406e68f8fe8bfb00fe8b4a6e688b7e7aea1e79086e591980221023490ddcb46ef84c96bbd2ad062f17b489f5b7d37ff0de8fdb2594bfd28ce602d21031213fe0daeff95364ef9dcacf8e2a438165a615fd259eff1cc98c80270ccc4f2012102e58d96754bfc717f69afa290064382516aa033baf67cd6cd4c384668aeb89c7f82c220347b3ae4a14de3781314cbbb1ce135e19d330bfa4d71691f7923d576b42c92c5c314744dc39b4bb0bcaeb507654404676c46c1a635bd88473045022100af1b362f474aa99c9bad9b745cb48b8e950b223ab61562cfe592407754ff1d7102203bdf5b367a3d69b8bf80a6c956ab54bd09e13297c62363bb83a133fee00c557dac"));

		Sha256Hash merkleHash = gengsisBlock.getBlock().buildMerkleHash();

		if(log.isDebugEnabled()) {
			log.debug("the gengsis block merkle hash is : {}", merkleHash);
		}
		Utils.checkState("4f82d41f43deeed7e773011b3912f987969d9d612360e30c785189764c9bb127".equals(Hex.encode(merkleHash.getBytes())), "the gengsis block merkle hash is error");

		if(log.isDebugEnabled()) {
			log.debug("the gengsis block hash key is : {}", gengsisBlock.getBlock().getHash());
		}
		Utils.checkState("0998de0bf1d533dc0bcbed6806410c5235d7caaf07419fabcb134944d34c3f56".equals(Hex.encode(gengsisBlock.getBlock().getHash().getBytes())), "the gengsis block hash is error");

		return gengsisBlock;

	}
	
	@Override
	public int getProtocolVersionNum(ProtocolVersion version) {
		return version.getVersion();
	}

	@Override
	public MessageSerializer getSerializer(boolean parseRetain) {
		return new DefaultMessageSerializer(this);
	}

	/**
	 * 获取该网络的认证管理账号的hash160
	 * @return byte[]
	 */
	@Override
	public byte[] getCertAccountManagerHash160() {


		//return Hex.decode("8e168bb4963f0523b9ee1c734d3c142976581930");//root
		//return Hex.decode("b326aeb9c6710864441b7c6a282ce924b4c31749");//manager
		return Hex.decode("481e05c83604abf86cca029c4260674c45c85c58");//cer_manager_1
	}

	@Override
	public byte[] getCommunityManagerHash160() {
		return Hex.decode("481e05c83604abf86cca029c4260674c45c85c58");//cer_manager_1
	}

	/**
	 * 测试网络，普通地址以t开头
	 */
	@Override
	public int getSystemAccountVersion() {
		return 128;
	}

	/**
	 * 测试网络，认证地址以c开头
	 */
	@Override
	public int getCertAccountVersion() {
		return 88;
	}
}
