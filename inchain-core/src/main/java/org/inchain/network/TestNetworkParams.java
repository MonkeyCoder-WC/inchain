package org.inchain.network;

import java.net.InetSocketAddress;

import org.inchain.Configure;
import org.inchain.crypto.Sha256Hash;
import org.inchain.message.DefaultMessageSerializer;
import org.inchain.message.MessageSerializer;
import org.inchain.store.BlockStore;
import org.inchain.utils.Hex;
import org.inchain.utils.Utils;

/**
 * 测试网络
 * @author ln
 *
 */
public class TestNetworkParams extends NetworkParams {

	public TestNetworkParams() {
		seedManager = new RemoteSeedManager();


//    	seedManager.add(new Seed(new InetSocketAddress("47.93.16.125", Configure.DEFAULT_PORT)));
//    	seedManager.add(new Seed(new InetSocketAddress("119.23.249.26", Configure.DEFAULT_PORT)));
//   	seedManager.add(new Seed(new InetSocketAddress("119.23.253.3", Configure.DEFAULT_PORT)));
//    	seedManager.add(new Seed(new InetSocketAddress("119.23.254.99", Configure.DEFAULT_PORT)));
		seedManager.add(new Seed(new InetSocketAddress("192.168.1.190", Configure.DEFAULT_PORT)));
		seedManager.add(new Seed(new InetSocketAddress("192.168.1.186", Configure.DEFAULT_PORT)));
		seedManager.add(new Seed(new InetSocketAddress("192.168.1.187", Configure.DEFAULT_PORT)));
		init();
	}


	public TestNetworkParams(SeedManager seedManager) {
		this.seedManager = seedManager;
		init();
	}

	private void init() {

		id = ID_TESTNET;

		packetMagic = 629268989L;

		this.acceptableAddressCodes = new int[] {getSystemAccountVersion(), getCertAccountVersion()};
	}

	/**
	 * 测试网络的创世块
	 */
	@Override
	public BlockStore getGengsisBlock() {
		BlockStore gengsisBlock = new BlockStore(this, Hex.decode("0000000000000000000000000000000000000000000000000000000000000000000000004b973e2e38d3ff0d979e72ea0314219e3b7464eab142bbbc90e75a4046e94707c6d57e59000000000000c6d57e59832102883a9625a871e79c070e316edafc97eac2f6c97b218d0e55726f25be2a963e9276a9144237cccf6ff9a7674a8fc47c60278fdd23e9f3098847304502210081e4ebbcbd7e30fb01ed793c1622044a71bae8b88624b28bcb36ac3e5d6c780602205a278475b8fdf882b50cc498f9aa5369628ee6655d32f8c086cfe5a5ec79b14fac140101000000010012117468697320612067656e6773697320747800000000010080faca73f91f00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688acc6d57e5900000000000201000000010180e2f936048acbb42210cfb37f268eaaba178622a2348a5a9284a864b562cdd9000000006b483045022100f40120ad50603fb13417396733b9521f6684f1b91a8bf0ac8ce2b24abe436d5202205a6833f8570306fc7533e56464069c4a2fb42589d522aced446e33b1faf3e78201210276c52ff14acd4c4d3e08f9596e0127a15e98207b3d0024426364825cd724c86dffffffff020080c6a47e8d03000078c2481976a9144237cccf6ff9a7674a8fc47c60278fdd23e9f30988ac00003426f56b1c00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688acc6d57e5900000000000601000000c6d57e5900000000832102883a9625a871e79c070e316edafc97eac2f6c97b218d0e55726f25be2a963e9276a9144237cccf6ff9a7674a8fc47c60278fdd23e9f30988473045022100ca6995b7279e44514c097cda01b77d8dc834e74a15dd38a89c91d7247bffd33202201cdd1332c978f63744a1328a5218171c54f6ec3f13cc7ed16879a02042cf7b5fac4237cccf6ff9a7674a8fc47c60278fdd23e9f309010000000000000000000000000000000000000000000000000000000000000000000000000000000000020100000001017cbcda0a286724a6a91a6fdb198692b6251e17e747eb3e6b29fd41dc11d20706010000006b483045022100aa1b5544382ad03fe8ce9d41e4774f5964a580d802e28cf23b2eb803c30e9962022014ea42890d85cb7ef99d634c531dc053db2ed7a2471114ea6f424ec58c75650b01210276c52ff14acd4c4d3e08f9596e0127a15e98207b3d0024426364825cd724c86dffffffff020010a5d4e8000000000000001976a9144237cccf6ff9a7674a8fc47c60278fdd23e9f30988ac00c0b91502111c00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688acc6d57e59000000000003010000000000c6d57e590000000000822102883a9625a871e79c070e316edafc97eac2f6c97b218d0e55726f25be2a963e9276a9144237cccf6ff9a7674a8fc47c60278fdd23e9f3098846304402202c095a1a960e146926eedf1319dd8895cbc63735217823a8c5ee066724d5e6d802204b5a77d6b256d7a97a61d1fc2aea893d5f7806e8bb93729e5c57c66835087701ac317c72974237cccf6ff9a7674a8fc47c60278fdd23e9f3090601000000c6d57e5900000000822103a7db4a854e3f2ae3a30aa759bfd39045f6a80c967b3fd81036acebc54b557ece76a9142c1179b1e05fb8652644f6c61a033d28431009128846304402203af52de6c97440cf9075e0b9270495230139741acd061102c2b5994d2e5556cc0220429c9ae5ed096d1f3c140333a9145971d985e8bbf70dbafd54836e5d79327e02ac2c1179b1e05fb8652644f6c61a033d2843100912010000000000000000000000000000000000000000000000000000000000000000000000000000000000020100000001010dc3402a1c8470ab49785da2546101fc2dbaf1d6a8e45fb691f1f30222b44fa7010000006b483045022100ca17347ecbab096cfa243c09bb82db9e013054a67329a526086871682b72ad33022003897150792f41590eb03c48cdefbd4419103b94b428f3baa9d786928b29036301210276c52ff14acd4c4d3e08f9596e0127a15e98207b3d0024426364825cd724c86dffffffff020010a5d4e8000000000000001976a9142c1179b1e05fb8652644f6c61a033d284310091288ac00803f050fb61b00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688acc6d57e59000000000003010000000000c6d57e590000000000822103a7db4a854e3f2ae3a30aa759bfd39045f6a80c967b3fd81036acebc54b557ece76a9142c1179b1e05fb8652644f6c61a033d2843100912884630440220161deab36f0d6704455b2d5fa1a8c7debac52e1c4caeefbe5128ab326982327402204ae903c2b7abffc076878c5ff5a35f7463d5c1ec691087a5222e3475f8e37511ac427c72972c1179b1e05fb8652644f6c61a033d28431009120601000000c6d57e59000000008321033e371b2f3d42dd525833bcce12cb0d404fb73898bdea3e6794bd8ec552c9ba9c76a914b3fcd687a5c2b2617de0d504cfa7d12db93bb00c8847304502210099f6b2d63cf300f5993ec2239e1ad434dcd6c3a15ad50387f86f4b05889f807002206840ca23ec4bff94c8549002559946bee4387f1c6554a6fc96cee2d08dfc46c2acb3fcd687a5c2b2617de0d504cfa7d12db93bb00c010000000000000000000000000000000000000000000000000000000000000000000000000000000000020100000001014dc72465d506d50ed51d5139a25cfeb7f0c9f2eedbdfe6079ee0c6c79b0a0028010000006a473044022045c3a90f960a326961cc7b24a9cf02bdc2e28aea129f11bb0ad389898ab63ccf0220232777b78ac8699d0353e1f95325c2be97af3ba5fadb6ee5be28c27aa45bb56201210276c52ff14acd4c4d3e08f9596e0127a15e98207b3d0024426364825cd724c86dffffffff020010a5d4e8000000000000001976a914b3fcd687a5c2b2617de0d504cfa7d12db93bb00c88ac0040c5f41b5b1b00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688acc6d57e59000000000003010000000000c6d57e5900000000008321033e371b2f3d42dd525833bcce12cb0d404fb73898bdea3e6794bd8ec552c9ba9c76a914b3fcd687a5c2b2617de0d504cfa7d12db93bb00c88473045022100d0578e407dd47b8cd6dd723e8b2d3b865e696d305619c5cae9a06850448952a802203692fd0ef32492aed476db714a794bdde0b0f15933e962b4a74dbca90440d898ac487c7297b3fcd687a5c2b2617de0d504cfa7d12db93bb00c0601000000c6d57e5900000000822103bf7759e9b81f8ff1b99732b3ee36aea0abff68c818b8839c318ad350e9642cb076a914c3bfdb8a67f35b6e4ea1ee3ae7b91eff58ec81a88846304402200da96f1fc4d885b39c025c9e92f94cf2e0482f468accbee041c962307ed62ec1022064b105b3cacb5b40a97d0a772df28a847df37814a29bd4fd6a5a84e0ebbd3fc0acc3bfdb8a67f35b6e4ea1ee3ae7b91eff58ec81a80100000000000000000000000000000000000000000000000000000000000000000000000000000000000201000000010198138a4a49e2c42bc9f18c74b5e7341c9afa2a2474655e4d44f645c0798f15b0010000006b4830450221008ff73307f4c9b17b5b15e6623057dec295370bf2aa602bd98907a8cb7f632cd1022013372cb291d625fa8be9c40d2b0476625513aba71626fb603f31c2cdb5d676d301210276c52ff14acd4c4d3e08f9596e0127a15e98207b3d0024426364825cd724c86dffffffff020010a5d4e8000000000000001976a914c3bfdb8a67f35b6e4ea1ee3ae7b91eff58ec81a888ac00004be428001b00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688acc6d57e5900000000000601000000c6d57e590000000082210200d482122f8537ad2fa1af1914e088d6b308824a8ef4dc8b68fa0e0a88c484e376a9145f1a078b610d92a3110b2c1a7f880b0d2442e530884630440220139a9320dfd909a40c3e78c664e0e50348f72796fa4a6007341c76051b4ef22702200abf1a304fc665992ffe6b1af38d7d967e2d68ab51cadb011c788a1a49a77ea3ac5f1a078b610d92a3110b2c1a7f880b0d2442e530010000000000000000000000000000000000000000000000000000000000000000000000000000000000020100000001012085bf61a3ff42c064f8290c12d7d1aab08098157af938d9028f517cf103e4e9010000006a47304402203da0e9d1d2d934a7d8a85101e7530cc4482d6f29acad97d035bbaee5498b2ec002203e21c926c985415840786a338bd1ecb124bb9ae310db92774fdd5f56649e616001210276c52ff14acd4c4d3e08f9596e0127a15e98207b3d0024426364825cd724c86dffffffff020010a5d4e8000000000000001976a9145f1a078b610d92a3110b2c1a7f880b0d2442e53088ac00c0d0d335a51a00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688acc6d57e5900000000000601000000c6d57e5900000000832103e8769d1901a4ef006054405c16716d6648fffe628385db5586c7fa18c3df5da876a914df639c6066a817a6be28b532839f8e1e85594cd4884730450221008a94ecbf4416b4057ec6df80ee75d4be135461f41f32c079c46eb3549b0edb3d0220186c451beafeeeff4df2b1629a74591a5de4a3093ce35a5f34a933004d9347f2acdf639c6066a817a6be28b532839f8e1e85594cd4010000000000000000000000000000000000000000000000000000000000000000000000000000000000020100000001019eac07a0a4a3615051ddf5edd79f287d9b304e8db68915117f397a9615ced03d010000006b483045022100de4a4b7d1c7282229aea7a3b78e5e18cb863f727f7fd3e88e9ce22d995a7d3e8022011c4e4888729a9959c0dbe57bc7ae95f0a1cf30b82db7845250ec6d3a60f2c8401210276c52ff14acd4c4d3e08f9596e0127a15e98207b3d0024426364825cd724c86dffffffff020010a5d4e8000000000000001976a914df639c6066a817a6be28b532839f8e1e85594cd488ac008056c3424a1a00000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688acc6d57e5900000000000601000000c6d57e5900000000832103368f8061e02694e37da199c07c3e2f2506cdd748efee493f0d1c52ae7494428f76a914e3453a80144f6ac24baf01f20455c6167b98548588473045022100eabee8f52ac93189fe94c6808f522f1410d461f4a9917cf89d891ba5bbca34e702207e40311da5c075ba99e889f8e8ceea0d3b49161f2ed448327a5bb7903b8e7140ace3453a80144f6ac24baf01f20455c6167b985485010000000000000000000000000000000000000000000000000000000000000000000000000000000000020100000001011a429bd69c22696c556444497b7cfa24d0d9d04039a5f3582c14f1ffd4139804010000006a473044022014e3cbbf2bfa8b01ee98b69b5a6319ac4f37bbecc20ed8e75dbd5d2303ab663202204effa6f7c868f08720630f02859ffa49207b052e2315af88276db96021ac83e001210276c52ff14acd4c4d3e08f9596e0127a15e98207b3d0024426364825cd724c86dffffffff020010a5d4e8000000000000001976a914e3453a80144f6ac24baf01f20455c6167b98548588ac0040dcb24fef1900000000001976a914bb7e4d6ffb3266a0b533b21847bef4dacce95f4688acc6d57e5900000000000b0100000049d57e590000000082c220d044e9265e2bd8d5c01c428714a5971f9d9583e07ffa96ddacc422c7caae221cc3149632de5a1ace61c1937bb19cc76ee6f4622fa38588473045022100c57a1e79b404219fe5e0108fe9cc0be0af1fd70022bcc38e499cd37f12220317022018e57cd2b0d06320301cb8a57e8ee680c89f146fc213ac4404a7c9f2bf65b837ac9632de5a1ace61c1937bb19cc76ee6f4622fa3859632de5a1ace61c1937bb19cc76ee6f4622fa38501fd23022b046e616d6506e5908de7a7b01ee9878de5ba86e58db0e993bee7a791e68a80e69c89e99990e585ace58fb822076164647265737306e59cb0e59d8012e9878de5ba86e5b882e58d97e5b2b8e58cba44046c6f676f06e59bbee7898737687474703a2f2f66696c652e696e636861696e2e6f72672f696d616765732f696e636861696e5f6c6f676f5f313030783130302e706e672b0a637265646974436f64650ce4bfa1e794a8e4bba3e7a0811239313530303130384d41355542333248334e1a0570686f6e6506e794b5e8af9d0c3032332d383633333130363927077765627369746506e5ae98e7bd911768747470733a2f2f7777772e696e636861696e2e6f7267fd1d0108646573637269707406e68f8fe8bfb0fd0a01e9878de5ba86e58db0e993bee7a791e68a80e69c89e99990e585ace58fb8e698afe4b880e5aeb6e4bba5e58cbae59d97e993bee68a80e69cafe9a9b1e58aa8e79a84e5889be696b0e59e8be4bc81e4b89aefbc8ce585b6e4b8bbe5afbce79a84e58cbae59d97e993bee7a4bee58cbae9a1b9e79bae496e636861696e2de58db0e993bee698afe4b880e4b8aae4bba5e998b2e4bcaae4b8bae59fbae7a180e4b89ae58aa1e79a84e585ace5bc80e5b9b3e58fb0efbc8ce4b8bae7a4bee4bc9ae59084e4bc81e4b89ae38081e69cbae69e84e38081e889bae69cafe5aeb6e7ad89e68f90e4be9be59381e7898ce38081e79fa5e8af86e4baa7e69d83e4bf9de68aa4e69c8de58aa1e3808202210319eba8f91229dd87c7879817c908d5ca3c673ab042420e59438e22c93dee8f482102dad8daa226d62996ce84aba6fecb40ba634c19fe9750265ec586ec618506d912012103963f9e07432d7f7d0dd940dd65aea7fa557a97b5c0d38a4c174f2fa206eb4b9000"));

		Sha256Hash merkleHash = gengsisBlock.getBlock().buildMerkleHash();

		if(log.isDebugEnabled()) {
			log.debug("the gengsis block merkle hash is : {}", merkleHash);
		}
		Utils.checkState("4b973e2e38d3ff0d979e72ea0314219e3b7464eab142bbbc90e75a4046e94707".equals(Hex.encode(merkleHash.getBytes())), "the gengsis block merkle hash is error");

		if(log.isDebugEnabled()) {
			log.debug("the gengsis block hash key is : {}", gengsisBlock.getBlock().getHash());
		}
		Utils.checkState("3fdc7d77bbd688f98fa4f59a217dd42fda74f0780ecb43ecd154a2fd2ea4c5ac".equals(Hex.encode(gengsisBlock.getBlock().getHash().getBytes())), "the gengsis block hash is error");

		return gengsisBlock;

	}

	@Override
	public int getProtocolVersionNum(ProtocolVersion version) {
		return version.getVersion();
	}

	@Override
	public MessageSerializer getSerializer(boolean parseRetain) {
		return new DefaultMessageSerializer(this);
	}

	/**
	 * 获取该网络的认证管理账号的hash160
	 * @return byte[]
	 */
	@Override
	public byte[] getCertAccountManagerHash160() {


		//return Hex.decode("8e168bb4963f0523b9ee1c734d3c142976581930");//root
		//return Hex.decode("b326aeb9c6710864441b7c6a282ce924b4c31749");//manager
		return Hex.decode("481e05c83604abf86cca029c4260674c45c85c58");//cer_manager_1
	}

	@Override
	public byte[] getCommunityManagerHash160() {
		return Hex.decode("481e05c83604abf86cca029c4260674c45c85c58");//cer_manager_1
	}

	/**
	 * 测试网络，普通地址以t开头
	 */
	@Override
	public int getSystemAccountVersion() {
		return 128;
	}

	/**
	 * 测试网络，认证地址以c开头
	 */
	@Override
	public int getCertAccountVersion() {
		return 88;
	}
}
